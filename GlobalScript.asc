// A function that initializes a bunch of stuff. -----------------------------------------------------
function initialize_control_panel() { 

  // Center the control panel
  gControlPanel.Centre();
    
  // Set all the defaults
  System.Volume = 70;
  sldAudio.Value = System.Volume;
  SetGameSpeed(70);
  sldSpeed.Value = 70;
 
}
// ------------------- End Initialize ----------------------------------------------------------------

// ------------------- Save Game Dialog --------------------------------------------------------------
function show_save_game_dialog()
{
  
  gSaveGame.Visible = true;
  // Get the list of save games
  lstSaveGamesList.FillSaveGameList();
  
  if (lstSaveGamesList.ItemCount > 0)
  {
    // If there is at least one, set the default text
    // to be the first game's name
    txtNewSaveName.Text = lstSaveGamesList.Items[0];
  }
  else
  {
    // No save games yet, default empty text.
    txtNewSaveName.Text = "";
  }
  mouse.UseModeGraphic(eModePointer);

}
// ------------------End Save Dialog------------------------------------------------------------------


//------------------ Restore Game Dialog -------------------------------------------------------------
function show_restore_game_dialog()
{
  gRestoreGame.Visible = true;
  lstRestoreGamesList.FillSaveGameList();
  mouse.UseModeGraphic(eModePointer);
  
}
//------------------End Restore Dialog---------------------------------------------------------------

// --- SAVE functions ----
function close_save_game_dialog()
{
  gSaveGame.Visible = false;
  mouse.UseDefaultGraphic();
}

function btnCancelSave_OnClick(GUIControl *control, MouseButton button)
{
  close_save_game_dialog();
}

function btnSaveGame_OnClick(GUIControl *control, MouseButton button)
{
  int gameSlotToSaveInto = lstSaveGamesList.ItemCount + 1;
  int i = 0;
  
  while (i < lstSaveGamesList.ItemCount)
  {
    if (lstSaveGamesList.Items[i] == txtNewSaveName.Text)
    {
      gameSlotToSaveInto = lstSaveGamesList.SaveGameSlots[i];
    }
    i++;
  }
  SaveGameSlot(gameSlotToSaveInto, txtNewSaveName.Text);
  close_save_game_dialog();
}


function lstSaveGamesList_OnSelectionCh(GUIControl *control)
{
  txtNewSaveName.Text = lstSaveGamesList.Items[lstSaveGamesList.SelectedIndex];
}


function txtNewSaveName_OnActivate(GUIControl *control)
{
  // Pressing return in the text box simulates clicking the Save button
  btnSaveGame_OnClick(control, eMouseLeft);
}

function btnDeleteSave_OnClick(GUIControl *control, MouseButton button)
{
  if (lstSaveGamesList.SelectedIndex >= 0)
  {
    DeleteSaveSlot(lstSaveGamesList.SaveGameSlots[lstSaveGamesList.SelectedIndex]);
    lstSaveGamesList.FillSaveGameList();
  }
}
// ------------ End SAVE functions -------------


// ----- RESTORE functions ---------------------

function close_restore_game_dialog()
{
  gRestoreGame.Visible = false;
  mouse.UseDefaultGraphic();
}

function btnCancelRestore_OnClick(GUIControl *control, MouseButton button)
{
  close_restore_game_dialog();
}


function btnRestoreGame_OnClick(GUIControl *control, MouseButton button)
{
  if (lstRestoreGamesList.SelectedIndex >= 0)
  {
    RestoreGameSlot(lstRestoreGamesList.SaveGameSlots[lstRestoreGamesList.SelectedIndex]);
  }
  close_restore_game_dialog();
}
// ---- End RESTORE functions


//Loading
function btnLoad_OnClick(GUIControl *control, MouseButton button)
{
  gControlPanel.Visible = false;
  mouse.UseDefaultGraphic();
  Wait(1);
  show_restore_game_dialog();
}

//Resume
function btnResume_OnClick(GUIControl *control, MouseButton button)
{
  gControlPanel.Visible = false;
  mouse.UseDefaultGraphic();
}


//Inventory Quit
function btnQuit_OnClick(GUIControl *control, MouseButton button)
{
  //gControlPanel.Visible = false;
  //Wait(1);
  //QuitGame(1);
  gControlPanel.Visible = true;
  mouse.UseModeGraphic(eModePointer);
}

//Control Panel Quit
function btnQuit2_OnClick(GUIControl *control, MouseButton button)
{
  gControlPanel.Visible = false;
  Wait(1);
  QuitGame(1);
  gControlPanel.Visible = true;
  mouse.UseModeGraphic(eModePointer);
}

//Audio Change
function sldAudio_OnChange(GUIControl *control)
{
  System.Volume = sldAudio.Value;
}

//Speed Change
function sldSpeed_OnChange(GUIControl *control)
{
  SetGameSpeed(sldSpeed.Value);
}

function btnSave_OnClick(GUIControl *control, MouseButton button)
{
    gControlPanel.Visible = false;
    show_save_game_dialog();
}


//----------------------------------------------------------------------------------------------------
// game_start
//----------------------------------------------------------------------------------------------------
function game_start() 
{
}

//----------------------------------------------------------------------------------------------------
// repeatedly_execute
//----------------------------------------------------------------------------------------------------
function repeatedly_execute() 
{
}

//----------------------------------------------------------------------------------------------------
// repeatedly_execute_always
//----------------------------------------------------------------------------------------------------
function repeatedly_execute_always() 
{
}

//----------------------------------------------------------------------------------------------------
// on_key_press
//----------------------------------------------------------------------------------------------------
function on_key_press(eKeyCode keycode) 
{
  if (IsGamePaused()) keycode = 0;
  
  // "System Keys"
  if (keycode == eKeyCtrlQ) QuitGame(1); // Ctrl-Q
  if (keycode == eKeyF9) RestartGame(); // F9
  if (keycode == eKeyF12) SaveScreenShot("scrnshot.pcx");  // F12
  
  // Debugger Keys
  if (keycode == eKeyCtrlS) Debug(0,0); // Ctrl-S, give all inventory
  if (keycode == eKeyCtrlV) Debug(1,0); // Ctrl-V, version
  if (keycode == eKeyCtrlA) Debug(2,0); // Ctrl-A, show walkable areas
  if (keycode == eKeyCtrlX) Debug(3,0); // Ctrl-X, teleport to room
  
  
 if ((keycode == eKeyEscape) && (gSaveGame.Visible))
  {
    // Use ESC to close the save game dialog
    close_save_game_dialog();
    return;
  }
  
  
  if ((keycode == eKeyEscape) && (gRestoreGame.Visible))
  {
    // Use ESC to close the restore game dialog
    close_restore_game_dialog();
    return;
  }
  
  if ((keycode == eKeyEscape) && gControlPanel.Visible) {
    // Use ESC to turn the panel off.
    gControlPanel.Visible = false; 
    mouse.UseDefaultGraphic();
    return;
  }
  
    // FUNCTION KEYS AND SYSTEM SHORTCUTS
  if (keycode == eKeyEscape) {
    // ESC
    gControlPanel.Visible = true; 
    mouse.UseModeGraphic(eModePointer);
  }
}

//----------------------------------------------------------------------------------------------------
// on_mouse_click
//----------------------------------------------------------------------------------------------------
function on_mouse_click(MouseButton button)
{
	// all mouse clicks are handled in TwoClickHandler.asc!
}

//----------------------------------------------------------------------------------------------------
// on_event
//----------------------------------------------------------------------------------------------------
function on_event (EventType event, int data) 
{
}

//----------------------------------------------------------------------------------------------------
// unhandled_event
//----------------------------------------------------------------------------------------------------
function unhandled_event (int what, int type) 
{
	if (what == 1) // Unhandled events for HOTSPOTS
	{
		if (type == 1) // look
		{
			player.Say("&1 Meh. Nothing special.");
		}
		if (type == 2) // interact
		{
			player.Say("&2 I can't do anything with it.");
		}
		if (type == 3) // use inv on
		{
			player.Say("&3 That won't do a thing.");
		}
	}
	if (what == 2) // Unhandled events for OBJECTS
	{
		if (type == 0) // look
		{
			player.Say("&4 Looks like a thing.");
		}
		if (type == 1) // interact
		{
			player.Say("&5 I don't want it.");
		}
		if (type == 3) // use inv on
		{
			player.Say("&6 That's a silly thing to do.");
		}
	}
	if (what == 3) // Unhandled events for CHARACTERS
	{
		if (type == 0) // look
		{
			player.Say("&7 Another one of God's children.");
		}
		if (type == 1) // interact
		{
			player.Say("&8 I don't have anything to say.");
		}
		if (type == 3) // use inv on
		{
			player.Say("&9 I don't think I should give that away.");
		}
	}
	if (what == 5) // Unhandled events for INVENTORY ITEMS
	{
		if (type == 0) // look
		{
			player.Say("&10 Just stuff in my pocket.");
		}
		if (type == 1) // interact
		{
			player.Say("&11 Um, no?");
		}
		if (type == 3) // use inv on
		{
			player.Say("&12 That's ridiculous.");
		}
	}
}

//----------------------------------------------------------------------------------------------------
// dialog_request
//----------------------------------------------------------------------------------------------------
function dialog_request(int param) 
{
}

//----------------------------------------------------------------------------------------------------
// gInventoryBar
//----------------------------------------------------------------------------------------------------
function btnInvScrollLeft_OnClick(GUIControl *control, MouseButton button)
{
	InventoryWindow1.ScrollDown();
}

function btnInvScrollRight_OnClick(GUIControl *control, MouseButton button)
{
	InventoryWindow1.ScrollUp();
}

//function btnQuit_OnClick(GUIControl *control, MouseButton button)
//{
  //Mouse.Visible = true;
	//QuitGame(1);
//}



// TEST INVENTORY ITEMS

// The "blue cup" inventory item
//function iBlueCup_Look()
//{
	//player.Say("You sure see them a lot these days!");
//}

//function iBlueCup_UseInv()
//{
	//player.Say("It's for holding coffee, or tea, or MAYBE cocoa. Nothing else.");
//}



//Church Sign buttons
function bQuit_OnClick(GUIControl *control, MouseButton button)
{
  QuitGame(0);
}

function bOptions_OnClick(GUIControl *control, MouseButton button)
{
  gControlPanel.Visible = true;
  mouse.UseModeGraphic(eModePointer);
}

function bStart_OnClick(GUIControl *control, MouseButton button)
{
  gSign.Visible = false;
  aGodbewithyou.Stop();
  
  //Start Game
  cDebra.ChangeRoom(1, 380, 213);
  
}
